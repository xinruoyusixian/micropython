import ssd1306,time

from machine import Pin,I2C
# using default address 0x3C
i2c = I2C(sda=Pin(4), scl=Pin(5))
d = ssd1306.SSD1306_I2C(128, 64, i2c)
    

#取模 格式 阴码 逆向 行列式 C51

font={
"0":[[0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00],[0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00]],#"0",0*/
"1":[[0x00,0x00,0x10,0x10,0xF8,0x00,0x00,0x00],[0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00]],#"1",0*/
"2":[[0x00,0x70,0x08,0x08,0x08,0x08,0xF0,0x00],[0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00]],#"2",0*/
"3":[[0x00,0x30,0x08,0x08,0x08,0x88,0x70,0x00],[0x00,0x18,0x20,0x21,0x21,0x22,0x1C,0x00]],#"3",0*/
"4":[[0x00,0x00,0x80,0x40,0x30,0xF8,0x00,0x00],[0x00,0x06,0x05,0x24,0x24,0x3F,0x24,0x24]],#"4",0*/
"5":[[0x00,0xF8,0x88,0x88,0x88,0x08,0x08,0x00],[0x00,0x19,0x20,0x20,0x20,0x11,0x0E,0x00]],#"5",0*/
"6":[[0x00,0xE0,0x10,0x88,0x88,0x90,0x00,0x00],[0x00,0x0F,0x11,0x20,0x20,0x20,0x1F,0x00]],#"6",0*/
"7":[[0x00,0x18,0x08,0x08,0x88,0x68,0x18,0x00],[0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x00]],#"7",0*/
"8":[[0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00],[0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00]],#"8",0*/
"9":[[0x00,0xF0,0x08,0x08,0x08,0x10,0xE0,0x00],[0x00,0x01,0x12,0x22,0x22,0x11,0x0F,0x00]],#"9",0*/
"10":[[0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00],[0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00]],#":",0*/
"/":[[0x00,0x00,0x00,0x00,0xC0,0x38,0x04,0x00],[0x00,0x60,0x18,0x07,0x00,0x00,0x00,0x00]],#"/",0*/

".":[[0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00],[0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00]],#*".",0*/

"-":[[0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00],[0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00]],#"-",0*/
"%":[[0xF0,0x08,0xF0,0x80,0x60,0x18,0x00,0x00],[0x00,0x31,0x0C,0x03,0x1E,0x21,0x1E,0x00]],#"%",0*/
"ssd":[[0x06,0x09,0x09,0xE6,0xF8,0x0C,0x04,0x02,0x02,0x02,0x02,0x02,0x04,0x1E,0x00,0x00],
[0x00,0x00,0x00,0x07,0x1F,0x30,0x20,0x40,0x40,0x40,0x40,0x40,0x20,0x10,0x00,0x00]],#"℃",0*/
"wen":[[0x10,0x60,0x02,0x8C,0x00,0x00,0xFE,0x92,0x92,0x92,0x92,0x92,0xFE,0x00,0x00,0x00],
[0x04,0x04,0x7E,0x01,0x40,0x7E,0x42,0x42,0x7E,0x42,0x7E,0x42,0x42,0x7E,0x40,0x00]],#"温",0*/
"du":[[0x00,0x00,0xFC,0x24,0x24,0x24,0xFC,0x25,0x26,0x24,0xFC,0x24,0x24,0x24,0x04,0x00],
[0x40,0x30,0x8F,0x80,0x84,0x4C,0x55,0x25,0x25,0x25,0x55,0x4C,0x80,0x80,0x80,0x00]],#"度",0*/
"shi":[[0x10,0x60,0x02,0x8C,0x00,0xFE,0x92,0x92,0x92,0x92,0x92,0x92,0xFE,0x00,0x00,0x00],
[0x04,0x04,0x7E,0x01,0x44,0x48,0x50,0x7F,0x40,0x40,0x7F,0x50,0x48,0x44,0x40,0x00]] #"湿",0*/
}




#清屏 可带参数清除指定区域 [0,127,0,8]  (0,127) 宽度,(0,8)是高度  1个高度是8像素 



d.newBuffer(font['8'],1,1)
d.newBuffer(font['wen'],50,50)
d.show()


while 1:

      humid="32.62"
      tempt="19.90"
      d.fill(0)
      h,m,s=(time.localtime()[3],time.localtime()[4],time.localtime()[5])
      d.text("%02d:%02d:%02d"%(h,m,s),30,10)
      posx=10
      poxy=20
      d.newBuffer(font['wen'],posx,poxy)
      d.newBuffer(font['du'],posx+20,poxy)
      d.newBuffer(font[tempt[0]],posx+40,poxy)
      d.newBuffer(font[tempt[1]],posx+50,poxy)
      d.newBuffer(font[tempt[2]],posx+60,poxy)
      d.newBuffer(font[tempt[3]],posx+70,poxy)
      d.newBuffer(font[tempt[4]],posx+80,poxy)
      d.newBuffer(font['ssd'],posx+90,poxy)

      d.newBuffer(font['shi'],posx,poxy+20)
      d.newBuffer(font['du'],posx+20,poxy+20)
      d.newBuffer(font[humid[0]],posx+40,poxy+20)
      d.newBuffer(font[humid[1]],posx+50,poxy+20)
      d.newBuffer(font[humid[2]],posx+60,poxy+20)
      d.newBuffer(font[humid[3]],posx+70,poxy+20)
      d.newBuffer(font[humid[4]],posx+80,poxy+20)
      d.newBuffer(font['%'],posx+95,poxy+20)
      if s>30:
        d.invert(0)
      else:
        d.invert(1)
      d.show()













